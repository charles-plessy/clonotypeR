Problem
-------

<pre>
yassai_identifier(c(V="TRAV14N-3", J="TRAJ16", dna="GCAACTTCAAGTGGCCAGAAGCTGGTT", pep="ATSSGQKLV"))
# takes ages

yassai_identifier(c(V="TRAV14N-3", J="TRAJ16", dna="GCAGCAACCGCAACTTCAAGTGGCCAGAAGCTGGTT", pep="AATATSSGQKLV"))
## [1] "aTa.2A14N3A16L12"
# returns immediately.
</pre>


Troubleshooting
---------------

The problematic clonotype comes from read `GWYEMNS10GHZUF`.

<pre>
&#64;GWYEMNS10GHZUF
gactAACTGGTACACAGCAGGTTCTGGGTTCTGGATGTGCAGGTACACCTTTAATATGGTCCCCTGGCCAAAAACCAGCTTCTGGCCACTTGAAGTTGCACAGAAGTAGGTGGCTGAGTCTCCAGGCTGAGAGTCTTTGATGTGCAAGGAGAGATTTTTCTCCCTTTTATTGAAGAAGATTGTGAATCGTCCATCTTCCTTTTTATCGGACACTGAACGTATGGCTATCAGGAGAGCAGGGCCTTCCCCAGGGAACTGCTGGTACCATGGGAAGTAGTCAAAAGCACTGTTCTCAtaactagcagttcagaattgcggtctctccttccccagactgtcagagattggagtcgtgggagacaaggcacacaggggataggngngnnnnnnnnnnnnn
+
FFF::;;FFFFFFFFIIIIHFFFHF666=&lt;FFGGDDDFFHFDIIIIIIIHHHIIIHFFFD54449662200001335&gt;&gt;AAABDFDDDFDDDFFFFFFFFFFFFFFFFFCCCCCFFFFFFFFFFFFDDBBBBB==110?&#64;&#64;&#64;&#64;&#64;&gt;4455BBA??3357;F4:::;;==D88?AA&lt;;:==BAAAA==??AAB&#64;AAA=&gt;&gt;&gt;222//02A8898BDDFFFDDFFFFFF666:DBAAAABB:::???DD;;;;D?????DDBA?&lt;&lt;&lt;&gt;&lt;&lt;&lt;&lt;000444&lt;8993222233393...:663322&lt;9233776899:;;963326755551111,,,,3313335333799.....23322666726;;;66772222,,,,47400!,!,!!!!!!!!!!!!!
</pre>

Here is the alignment made by clonotypeR

<pre>
GWYEMNS10GHZUF	16	TRAV14N-3	105	17	49S17M1I29M1I201M99S	*	0	0	NNNNNNNNNNNNNCNCNCCTATCCCCTGTGTGCCTTGTCTCCCACGACTCCAATCTCTGACAGTCTGGGGAAGGAGAGACCGCAATTCTGAACTGCTAGTTATGAGAACAGTGCTTTTGACTACTTCCCATGGTACCAGCAGTTCCCTGGGGAAGGCCCTGCTCTCCTGATAGCCATACGTTCAGTGTCCGATAAAAAGGAAGATGGACGATTCACAATCTTCTTCAATAAAAGGGAGAAAAATCTCTCCTTGCACATCAAAGACTCTCAGCCTGGAGACTCAGCCACCTACTTCTGTGCAACTTCAAGTGGCCAGAAGCTGGTTTTTGGCCAGGGGACCATATTAAAGGTGTACCTGCACATCCAGAACCCAGAACCTGCTGTGTACCAGTTAGTC	!!!!!!!!!!!!!,!,!00474,,,,22227766;;;62766622332.....9973335333133,,,,111155557623369;;:9986773329&lt;223366:...3933322223998&lt;444000&lt;&lt;&lt;&lt;&gt;&lt;&lt;&lt;?ABDD?????D;;;;DD???:::BBAAAABD:666FFFFFFDDFFFDDB8988A20//222&gt;&gt;&gt;=AAA&#64;BAA??==AAAAB==:;&lt;AA?88D==;;:::4F;7533??ABB5544&gt;&#64;&#64;&#64;&#64;&#64;?011==BBBBBDDFFFFFFFFFFFFCCCCCFFFFFFFFFFFFFFFFFDDDFDDDFDBAAA&gt;&gt;53310000226694445DFFFHIIIHHHIIIIIIIDFHFFDDDGGFF&lt;=666FHFFFHIIIIFFFFFFFF;;::FFF	AS:i:233	XS:i:218	XF:i:3	XE:i:4	XN:i:0
</pre>

The problem was that the V segment was completely digested in favor of the J segment.

<pre>
           351                                            400
GWYEMNS10GHZUF CTGTGCAACTTCAAGTGGCCAGAAGCTGGTTTTTGGCCAGGGGACCATAT
TRAJ16         ~~~~GCAACTTCAAGTGGCCAGAAGCTGGTTTTTGGCCAGGGGACCATAT
TRAV14N-3      CTGTGCAGC...AAGTG~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

           401                                            450
GWYEMNS10GHZUF TAAAGGTGTACCTGCACATCCAGAACCCAGAACCTGCTGTGTACCAGTTA
TRAJ16         TAAAGGTGTACCTGC~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRAV14N-3      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>

This triggered an infinite loop when calling `is.germline()`.

[[Done]] in `42ab98729c5c77462b5929b00ee973074ae4c1c7`.

Now the function should return as in the following example.

<pre>
yassai_identifier(c(V="TRAV14N-3", J="TRAJ16", dna="GCAACTTCAAGTGGCCAGAAGCTGGTT", pep="ATSSGQKLV"))
## [1] "a.A14N3A16L9"
</pre>
